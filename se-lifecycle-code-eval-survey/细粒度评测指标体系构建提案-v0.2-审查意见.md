# 细粒度评测指标体系构建提案 v0.2 — 第二轮审查意见

> **审查工具**: Codex (GPT-5.2 High Reasoning) | **审查日期**: 2026-02-28 | **消耗 token**: ~89K
>
> **审查范围**: 修复验证、内部一致性、残留问题抽查、改进建议

---

## 第一轮问题修复验证

| 问题 | 状态 | 备注 |
|------|------|------|
| arXiv 编号错误 | RESOLVED | 抽查 12 条全部匹配 |
| 缺少 Agent 维度 | RESOLVED | 第五章结构清晰，路线图已联动 |
| 缺少适用粒度 | RESOLVED | 所有指标卡片已覆盖 |
| 公式定义不严谨 | RESOLVED | SBC/IFR/NET/FC 已重写 |
| 缺失指标 | RESOLVED | 4 个新指标已补充 |
| 路线图结构 | RESOLVED | Phase 0-3 + 验收门槛 |

---

## 新发现问题汇总（41 条）

| 严重度 | 数量 | 关键问题 |
|--------|------|---------|
| Critical | 1 | 建立"指标主键 Metric ID"作为全局一致性锚点 |
| Major | 12 | ComUIBench/ComUICoder 命名不一致、TestGenEval 年份错误、万行 vs KLOC 单位冲突、Agent 指标定义需细化、汇总表排序/工具链对齐 |
| Minor | 8 | IFR 边界条件、加权合规率形式化、术语统一、编号风格 |
| Info | 20 | 确认各项修复到位的验证记录 |

---

## 一、修复验证详情

### 1.（Info）arXiv 编号错误修复：总体已显著改善
v0.2 的参考文献列表与正文引用大部分已做到"作者/主题/编号"一致，且抽查的多条 arXiv ID 可在 arXiv API 中解析到对应论文标题。

### 2.（Major）arXiv 相关仍引入了"名称/年份不一致"的新问题
- `2602.19276` 在 arXiv 上的标题是 ComUICoder（而不是 ComUIBench）。正文 1.5 写的是 "ComUICoder (2602.19276)"，但附录 B 与 7.3/7.1 等处使用了 ComUIBench，造成"同一编号多名称"的不一致。
- 参考文献第 31 条把 `2410.00752`（TestGenEval）标成 Varshney et al., 2026，但该 arXiv 条目发布时间是 2024-10，年份明显不匹配。

### 3.（Info）新增 Agent 维度：已完成且结构清晰
已新增"第五章 Agent 与交互式开发指标"，并在 7.1 汇总表、路线图 Phase 1/2 中体现了 Agent 指标的落地路径，逻辑闭环基本建立。

### 4.（Info）新增适用粒度：基本覆盖到每张指标卡
绝大多数指标均明确给出 snippet/file/repo 粒度；且 Agent 与维护阶段指标也覆盖到 repo 粒度。

### 5.（Major）"修正公式"虽整体更规范，但仍残留一个定义-公式冲突
4.3.1 标题写"万行代码缺陷率"，但公式使用的是 LoC/1000（即每千行 KLOC）作为归一化单位，并且后文基线也写的是"缺陷/KLOC"。指标命名与公式单位不一致，会直接导致读者理解错误。

### 6.（Info）补充缺失指标、重构路线图：已完成且比 v0.1 更可执行
v0.2 新增：2.4.4 供应链与依赖安全、3.7 测试稳定性、6.5 鲁棒性、6.6 开发者体验；并在 Phase 0-3 路线图中给出验收门槛与并行项。

---

## 二、内部一致性

### 7.（Info）章节编号结构：整体一致
主体 0/1/2/3/4/5/6/7 + 附录 A/B 的层级清晰；子编号连续，没有明显断号或重复号。

### 8.（Minor）"〇、背景与目标"的编号风格与后续混用
不影响内容，但如果后续要自动生成目录/锚点，可能出现排序或样式不统一。建议统一为"0/1/2…"或全中文序号。

### 9.（Major）4.3.1 指标命名与公式/基线单位不一致（万行 vs KLOC）
- 标题"万行代码缺陷率"暗示单位是每 10,000 行
- 公式与基线叙述却是每 1,000 行（KLOC）
- 建议二选一统一：改标题为"KLOC 缺陷密度/千行代码缺陷率"；或把公式里的 /1000 改成 /10000

### 10.（Minor）7.1 汇总表排序/一致性可再加强
2.4.4/3.7/6.5/6.6 被追加在表格末尾而非按编号顺序排列。建议按编号排序或按阶段分组。

### 11.（Major）同一数据集/基准名称在正文、汇总表、参考文献中不一致
`2602.19276`：正文倾向 ComUICoder，附录/表格出现 ComUIBench。

### 12.（Minor）附录 A 与正文名称有少量用词偏差
例如正文 6.2 是"数据污染鲁棒性"，附录 A 用"数据污染"；正文 4.3.1 是"万行代码缺陷率"，附录/7.1 更像"缺陷密度"。建议统一名称或在附录 A 用编号对齐。

---

## 三、残留问题抽查

### 3.1 arXiv 编号抽查（12 条）

| # | arXiv ID | 论文 | 结果 |
|---|----------|------|------|
| 13 | `2502.07835` | SBC / 逆向生成需求一致性 | Info - 匹配 |
| 14 | `2406.15877` | BigCodeBench | Info - 匹配 |
| 15 | `2602.10171` | EvoCodeBench | Info - 匹配 |
| 16 | `2602.11224` | Agent-Diff | Info - 匹配 |
| 17 | `2404.13161` | CyberSecEval 2 | Info - 匹配 |
| 18 | `2408.02487` | LiCoEval | Info - 匹配 |
| 19 | `2602.09540` | SWE-bench Mobile | Info - 匹配 |
| 20 | `2601.19494` | AACR-Bench | Info - 匹配 |
| 21 | `2509.01494` | SWR-Bench | Info - 匹配 |
| 22 | `2403.07974` | LiveCodeBench | Info - 匹配 |
| 23 | `2401.03065` | CRUXEval | Info - 匹配 |
| 24 | `2602.16741` | 对抗性注释攻击安全审查 | Info - 匹配 |

残留/新引入的引用问题：

### 25.（Major）编号正确但"名称错误"
`2602.19276` 对应的是 ComUICoder（正文 1.5 用 ComUICoder 是对的），但附录 B 与 7.1/7.3 使用 ComUIBench，需统一。

### 26.（Major）编号正确但"年份元数据错误"
`2410.00752`（TestGenEval）在附录 B 被写成 "Varshney et al., 2026"，年份与 arXiv 发布时间（2024-10）明显不匹配，建议改为 2024。

### 3.2 公式与符号一致性抽查

### 27.（Major）4.3.1 单位冲突（万行 vs /1000）
目前文档中最"会导致指标被算错/解释错"的点，建议优先修复。

### 28.（Minor）2.4.2 "加权合规率"描述不够形式化
文中写"Critical ×3, Major ×2, Minor ×1"，但未给出明确的加权分子/分母形式。建议补充：
`weighted_compliance = Σ(weight_i * pass_i) / Σ(weight_i)`，并说明 `pass_i∈{0,1}` 或按 rule 计数。

### 29.（Minor）1.2 IFR 在某类约束为空时的边界条件未说明
例如没有 runtime 约束时 n_runtime=0，建议声明"对为空的约束类型不计入分母"，避免实现时出现除零或隐含偏置。

### 30.（Major）2.2.7 代码自然性：工具链选择与"困惑度/交叉熵"定义存在方法学风险
文中建议用 CodeBERT/UniXcoder 计算困惑度，但它们多为 Masked LM / Encoder，严格意义上不能直接给出标准自回归 perplexity。建议明确：
- 采用何种概率模型（自回归 LM / n-gram LM / pseudo-PPL）
- tokenization 与跨语言可比性处理（BPE 差异会影响 cross-entropy）

### 3.3 Agent 指标严谨性抽查（5.1-5.5）

### 31.（Major）5.1 turn_efficiency 口径可能产生可比性问题
不同任务复杂度/任务拆分粒度会直接改变"任务数"的定义。建议改为更稳健的口径：
- `avg_turns_to_solve`（只对 solve 的样本统计平均轮数）
- `success@N`（N 轮内完成率）
- 或 "成本化"：`solve_per_1000_tokens / solve_per_minute`

### 32.（Major）5.2 工具调用正确性缺少"正确"的可操作定义
建议至少拆成三段：
1. `schema_valid_rate`（参数/JSON/类型正确）
2. `execution_success_rate`（工具实际执行成功）
3. `semantic_success_rate`（工具调用对任务推进有效）

### 33.（Minor）5.3 跨文件编辑一致性：分母定义需具体化
建议明确"编辑数"的计数单位（commit / diff-hunk / file-touch / function-change），并与可自动检测的判定绑定。

### 34.（Minor）5.4 环境搭建：reproducible_build_rate 的判定对象需明确
是"构建是否成功一致"还是"产物 hash 一致"？建议至少先用"成功/失败一致 + 关键测试通过一致"。

### 35.（Info）5.5 计划-执行-反思：已意识到需要 rubric + 抽检校准
v0.2 在路线图 Phase 2 给了 Judge 校准规范，方向正确；后续主要是把 rubric 细化成可执行表格。

---

## 四、改进建议

### 36.（Critical）建立"指标主键（Metric ID）"作为全局一致性锚点
现在很多一致性问题本质是"名称漂移"。建议把 1.1/2.4.4/… 作为唯一主键，所有表格/附录/路线图引用都以主键为准，名称允许有中文别名但必须一致映射。

### 37.（Major）为每个指标补充"方向性"和"统计口径"
建议在指标卡片加两行：
- `方向：↑/↓/越接近 1 越好`
- `报告方式：均值/中位数/分位数 + 置信区间 + 显著性检验（可选）`

### 38.（Major）7.1 汇总表与正文"工具链/数据来源"建议做一次一致性对齐
典型例子：1.1 SBC 在 7.1 里出现 sacrebleu，但正文 1.1 的实现并不依赖 BLEU。

### 39.（Major）防止指标重复计分：建议补一张"指标依赖图/去冗余策略"
建议在正文提前给一个简化版示例：
- 哪些是诊断指标（lint/complexity/smell）
- 哪些是结果指标（pass@k/回归安全性）
- 哪些是成本/体验指标（token/时延/acceptance）
并明确综合评分时的去重原则。

### 40.（Minor）统一术语：KLOC / LoC / lines_of_code 的写法与大小写
建议选一个（如 LoC），并在首次出现处定义计数规则（空行/注释是否计入）。

### 41.（Minor）对 LLM-as-Judge 指标补充"抗操纵"与"可解释输出"要求
建议补充：
- Judge 输出必须包含"扣分点证据"（引用代码片段/违反了哪条 rubric）
- 规定抽检比例与仲裁流程（人审覆盖率）

---

## 建议的下一步修改优先级

### 立即修复（3 个硬伤）
1. **4.3.1 万行 vs KLOC** — 统一标题与公式单位
2. **ComUIBench → ComUICoder** — 统一附录 B 和汇总表中的名称
3. **TestGenEval 年份** — 附录 B 中 2026 → 2024

### 高优先级（架构优化）
4. 建立 Metric ID 全局主键体系
5. 细化 Agent 指标（5.1 turn_efficiency、5.2 工具调用正确性分层）
6. 补充指标方向（↑/↓）和统计报告格式

### 中优先级（完善细节）
7. 构建指标依赖图
8. 统一术语（KLOC/LoC）
9. 形式化加权合规率公式
10. IFR 边界条件声明
11. 代码自然性工具链方法学说明
12. 汇总表排序与工具链对齐
