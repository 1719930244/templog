# REACT: IR-Level Patch Presence Test for Binary
# REACT：基于中间表示层的二进制补丁存在性测试

**来源**: ASE 2024 | **作者**: Qi Zhan 等

## 摘要
补丁存在性测试对于确保二进制文件已针对已知漏洞进行修补至关重要，但源代码与二进制之间的语义鸿沟以及补丁的细微特性使其极具挑战。本文提出React，首个在中间表示（IR）层面进行补丁存在性测试的方法。基于从源代码编译的IR和从二进制提升的IR，React通过符号执行提取四类特征（返回值、条件、函数调用、内存存储），然后对源代码特征进行精炼和排序，最后使用SMT求解器在语义层面匹配特征以判断补丁存在性。实验结果表明React达到0.88精确率、0.98召回率和0.93 F1分数，分别超越基线BinXray和PS3 39%和12%，且测试速度比BinXray快2倍、比PS3快100倍。

## 引言核心
- 96%的组织使用开源库，漏洞修补后用户需要确认其使用的二进制文件是否已打补丁
- 现有方法将问题从"源代码到二进制"转化为"二进制到二进制"，但缺乏语义信息使分析困难
- 现有方法通常只针对单一架构（FIBER针对Arm64，PS3针对Amd64），难以迁移
- IR可以桥接源代码与二进制之间的语义鸿沟，同一语言内的语义关系更直观
- 将问题重新定义为"IR到IR"，可统一不同架构和操作系统的分析

## 方法概述
React将补丁存在性测试从"源代码到二进制"重新定义为"IR到IR"。通过编译源代码获得参考IR代码，通过二进制提升（binary lifting）获得目标IR代码，均基于LLVM IR实现。

方法包含三个核心步骤：(1) 特征生成——通过符号执行基本块，从编译和提升的IR代码中提取四类特征：返回值、函数调用、内存存储和条件；(2) 特征精炼——由于编译器优化和局部变量的影响，生成的特征可能不适合直接匹配，因此提出特征精炼技术简化特征并保留独特部分，同时基于重要性对特征排序；(3) 特征匹配——逐一比较编译IR和提升IR的特征，使用SMT求解器在语义层面检查特征等价性。

## 关键实验发现
- RQ1（有效性）：React达到0.88精确率、0.98召回率、0.93 F1分数，分别超越BinXray和PS3 39%和12%
- RQ2（鲁棒性）：React对不同编译器和优化级别的组合更加鲁棒
- RQ3（消融实验）：SMT求解器和特征精炼分别贡献16%和10%的F1分数提升
- RQ4（效率）：React平均0.025秒检测一个补丁，比PS3快100倍，比BinXray快2倍

## 写作特征备注
- 标题结构：工具名缩写+任务描述（REACT: IR-Level Patch Presence Test for Binary）
- 摘要是否有数字：是（0.88、0.98、0.93、39%、12%、2x、100x）
- 是否有RQ：是（通过实验部分的研究问题组织）
- 是否有Motivating Example：是（Section 2通过CVE-2021-23841展示二进制提升的优势和补丁分析的洞察）
- 贡献点数量：3

## 结论
React首次将补丁存在性测试提升到IR层面，通过符号执行、特征精炼和SMT语义匹配，在准确性和效率上均显著超越现有方法，且具备跨架构和跨操作系统的适用性。
