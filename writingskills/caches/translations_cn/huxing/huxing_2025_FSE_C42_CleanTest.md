# Less Is More: On the Importance of Data Quality for Unit Test Generation
# 少即是多：数据质量对单元测试生成的重要性

**来源**: FSE 2025 | **作者**: Junwei Zhang 等

## 摘要
单元测试对软件开发至关重要，但编写测试代码耗时费力。近年来深度学习和大语言模型被用于自动化测试生成，但对训练数据集质量的研究有限。本文系统研究了噪声对学习型测试生成模型的影响。通过开放卡片分类法分析最大的测试生成数据集Methods2Test，归纳出8种噪声类型，并通过17位领域专家访谈验证。提出CleanTest自动噪声清洗框架，包含基于规则的语法过滤器、相关性过滤器和基于模型的覆盖率过滤器。研究发现Methods2Test中43.52%、Atlas中29.65%的数据包含噪声。使用过滤后数据集微调四种LLM，分支覆盖率平均提升67%（Methods2Test）和39%（Atlas），缺陷检测能力提升21.42%。

## 引言核心
- 学习型测试生成方法对训练数据集质量关注不足，噪声数据（如语法错误、低覆盖率测试）会降低模型性能
- 测试生成数据集的噪声模式不同于代码搜索或摘要任务，需要保证语法正确性、逻辑一致性和代码覆盖率
- 现有数据质量研究主要针对代码搜索和代码摘要，尚无针对测试生成数据集的系统研究
- Methods2Test和Atlas是最广泛使用的测试生成数据集，但噪声比例分别高达43.52%和29.65%
- 过滤噪声不仅提升测试生成质量，还能节省至少25%的训练时间

## 方法概述
CleanTest框架包含三个过滤组件。基于规则的语法过滤器通过系统设计的启发式规则消除具有异常语法特征的数据，如不必要的注解、空异常处理语句和空函数。基于规则的相关性过滤器选择与焦点方法强相关的数据，除了匹配测试代码中调用的函数名与焦点方法名外，还要求参数数量和类型匹配。基于模型的覆盖率过滤器利用预训练语言模型预测每个实例的代码覆盖率，保留分支覆盖率较高的数据。

在噪声分类方面，作者通过开放卡片分类法识别了8种噪声类型：模糊数据类型、不必要注解、空异常处理语句、缺失实现、语法错误、非英文字面量、不相关测试用例和低代码覆盖率。17位领域专家的访谈验证了该分类的合理性、正确性和完整性。

## 关键实验发现
- RQ1（噪声分布）：Methods2Test中43.52%为噪声，最大噪声类型为不必要注解（41.64%）；Atlas中29.65%为噪声，最大类型为语法错误（28.74%）
- RQ2（对测试生成的影响）：过滤后四种LLM在Methods2Test上分支覆盖率平均提升67.46%，Atlas上提升39.25%；编译通过率分别提升283.75%和19.37%
- RQ3（对缺陷检测的影响）：过滤噪声使生成测试检测到的缺陷数量增加21.42%
- RQ4（消融实验）：三个过滤组件各自对最终效果有正向贡献

## 写作特征备注
- 标题结构：格言型（"Less Is More" + 副标题说明具体研究主题）
- 摘要是否有数字：是（43.52%、29.65%、67%、39%、21.42%等）
- 是否有RQ：是（通过实验设计隐含多个RQ）
- 是否有Motivating Example：否（使用研究方法论概览图代替）
- 贡献点数量：4

## 结论
CleanTest框架有效识别和过滤测试生成数据集中的噪声，过滤后的数据集显著提升了LLM的测试生成能力和缺陷检测性能，同时节省了训练时间，证明了"少即是多"的数据质量理念。
