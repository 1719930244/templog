# The Lost World: Characterizing and Detecting Undiscovered Test Smells
# 失落的世界：未被发现的测试坏味道的特征化与检测

**来源**: TOSEM 2023 | **作者**: Yanming Yang 等

## 摘要
测试坏味道（test smell）指测试代码中的不良编程和设计实践，广泛存在于软件项目中，对测试代码的理解和维护产生负面影响，甚至使被测代码更容易出现缺陷。自Van Deursen等人引入"测试坏味道"定义以来，仅有少数研究从测试规范和从业者经验中发现新的测试坏味道。本文首次从Stack Overflow中系统挖掘软件从业者讨论的争议性测试实践，正式定义了六种新的测试坏味道类型，并开发了检测器。在1,200个手动标注的测试坏味道上，检测器达到100%精确率、98%召回率和99% F1值。在919个真实Java项目中，722个项目检测到这些坏味道，56份问题报告获得76.4%的开发者接受率。

## 引言核心
- 测试代码与生产代码的比例可达1:1到1:3，测试坏味道严重影响测试代码质量和可维护性
- 自2001年以来仅有9篇文献正式提出新的测试坏味道类型，学术研究滞后于实践
- 大量不良测试实践由从业者在开发中"观察"到，并在Stack Overflow等平台广泛讨论，但未被学术界正式定义
- 缺乏正式定义导致多数从业者无法识别潜在测试坏味道，继续使用不良实践
- 需要从从业者讨论中系统挖掘新的测试坏味道类型并提供检测工具

## 方法概述
本文以Stack Overflow为数据源，设计搜索策略收集讨论争议性测试实践的帖子，通过分类和分析答案的投票偏好确定潜在测试坏味道，最终总结出六种新的测试坏味道（包括一种项目级、两种语句级和三种方法级坏味道）。对每种坏味道类型提供了清晰定义，并调查了其对软件质量的危害性。

检测器的构建基于从SO帖子和GitHub项目中提取的代码模式，将测试代码转换为抽象语法树（AST），并为每种坏味道设计对应的语法规则作为检测方法。检测器在七个流行Java项目的手动标注数据集上进行评估，并在919个真实Java项目上进行大规模检测，最后向53个项目提交了56份问题报告进行实用性验证。

## 关键实验发现
- RQ1（有效性）：检测器在手动标注数据集上达到100%精确率、98%召回率、99% F1值，优于基线方法
- RQ2（普遍性与实用性）：六种测试坏味道在919个Java项目中的722个被检测到；56份问题报告获得76.4%的开发者接受率

## 写作特征备注
- 标题结构：隐喻式标题（The Lost World: 描述性副标题）
- 摘要是否有数字：是（100%精确率、98%召回率、99% F1值、919项目、722项目、56份报告、76.4%接受率）
- 是否有RQ：是
- 是否有Motivating Example：是（kestra项目的flaky test缺陷报告示例）
- 贡献点数量：4

## 结论
本文首次从软件从业者的Stack Overflow讨论中系统挖掘并正式定义了六种新的测试坏味道类型，开发的检测器在真实项目中验证了这些坏味道的普遍性和实用性，为测试代码质量改进提供了重要参考。
