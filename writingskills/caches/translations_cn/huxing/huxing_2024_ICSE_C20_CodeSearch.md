# Code Search Is All You Need? Improving Code Suggestions with Code Search
# 代码搜索就是你所需要的？通过代码搜索改进代码建议

**来源**: ICSE 2024 | **作者**: Junkai Chen 等

## 摘要
现代IDE提供各种自动代码建议技术（如代码补全和代码生成）帮助开发者提高效率，这些技术可能从代码库中检索相似代码片段或利用深度学习模型提供建议。然而，如何有效利用代码检索增强代码建议尚未被系统研究。本文研究并探索了一个检索增强的代码建议框架，利用不同的检索方法和搜索策略搜索相似代码片段，然后用检索到的代码进一步增强语言模型在代码建议上的性能。实验表明，该框架在BLEU-4指标上将代码补全和代码生成性能分别提升高达53.8%和130.8%。

## 引言核心
- 代码建议（代码补全和代码生成）是软件工程领域的重要研究课题
- 开发者通常先搜索相似代码再模仿编写，而非从零开始编码
- 先前检索增强方法通常为特定模型和搜索算法设计，难以与其他模型集成
- 如何有效结合不同代码搜索技术和代码建议模型仍不清楚
- 需要一个即插即用的框架，能灵活组合各种检索方法和语言模型

## 方法概述
该框架由三个组件组成：Retriever（检索器）、Formulator（格式化器）和Generator（生成器）。检索器分析源查询信息，使用三种搜索策略检索相似代码：Header2Code（方法头到代码）、NL2Code（自然语言到代码）和NL2NL（自然语言到自然语言）。检索方法包括IR-based（Lucene/BM25）和DL-based（ReACC-retriever、CodeBERT、Sentence-BERT）。

格式化器将检索到的相似代码与代码上下文组合，转换为生成器可处理的格式化输入。生成器是接收格式化输入并提供代码建议的语言模型，包括通用DL模型（如LSTM、Transformer-XL）和大语言模型（如ChatGPT）。该框架的特点是支持多种组合且即插即用，兼容各种检索方法和语言模型。

## 关键实验发现
- RQ1（有效性）：框架将Transformer-XL的代码补全性能提升高达53.8%（BLEU-4），将ChatGPT的代码生成性能提升高达130.8%（BLEU-4）
- RQ2（检索增强LLM）：少量检索示例即可充分增强性能；研究了不同shot数量和prompt模板的影响

## 写作特征备注
- 标题结构：问句式（Code Search Is All You Need? + 描述性副标题）
- 摘要是否有数字：是（53.8%、130.8%）
- 是否有RQ：是
- 是否有Motivating Example：是（Figure 1展示了开发者搜索代码辅助编程的常见场景）
- 贡献点数量：3

## 结论
本文提出的检索增强代码建议框架通过灵活组合不同搜索策略、检索技术和语言模型，显著提升了代码补全和代码生成的性能，证明了将检索过程集成到代码建议中能带来大幅性能提升。
