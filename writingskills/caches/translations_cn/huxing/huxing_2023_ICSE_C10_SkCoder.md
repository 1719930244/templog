# SkCoder: A Sketch-based Approach for Automatic Code Generation
# SkCoder：一种基于草图的自动代码生成方法

**来源**: ICSE 2023 | **作者**: Jia Li 等

## 摘要
深度学习技术在自动代码生成中取得了巨大成功。受代码复用启发，一些研究者提出基于复制的方法从相似代码中复制内容，但这些方法忽略了代码草图（sketch），倾向于不加修改地重复相似代码。本文提出SkCoder方法模拟开发者的代码复用行为：给定自然语言需求，检索相似代码片段，提取相关部分作为代码草图，再将草图编辑为目标代码。在三个数据集上的实验表明，SkCoder在Pass@1上比CodeT5-base分别提升30.30%、35.39%和29.62%，并能将不同代码生成模型的Pass@1提升高达120.1%。

## 引言核心
- 人类开发者在代码复用时会识别相似代码中与需求相关的内容（即代码草图），而非简单复制
- 现有基于复制的方法忽略了草图的重要性，倾向于不加修改地重复相似代码，导致生成错误结果
- 代码草图是代码复用的核心，它指定了可行的代码模式来指导开发者"如何写"
- 自然语言描述表达需求告诉模型"写什么"，草图提供模式告诉模型"怎么写"

## 方法概述
SkCoder包含三个模块：Retriever、Sketcher和Editor，以流水线方式工作。Retriever使用BM25相似度度量，通过Lucene搜索引擎从检索语料库中选择与输入自然语言描述最相似的代码片段。Sketcher基于输入描述从相似代码中提取代码草图，即识别与当前需求相关的内容并用占位符替换不相关部分。

Editor模块将草图作为软模板，结合输入的自然语言描述，通过编辑草图生成目标代码。具体而言，Editor理解需求并在草图的占位符位置填入实现细节（如函数名、条件语句等）。整个流程有效地从高质量代码语料库中挖掘知识并将其迁移到新生成的程序中。作者还收集了一个新的代码生成数据集AixBench-L，包含200k真实NL-代码对。

## 关键实验发现
- RQ1（有效性）：SkCoder在EM指标上比SOTA基线提升高达22.41%，比SOTA复制基线提升高达42.86%；在AixBench-L上Pass@1提升12.9%
- RQ2（消融研究）：逐步添加retriever和sketcher到不同代码生成模型，证明各模块的贡献，Pass@1最高提升120.1%
- RQ3（草图设计）：调查了三种可行的代码草图设计，证明草图的重要性及所选草图设计的优越性
- RQ4（人工评估）：从正确性、代码质量和可维护性三个方面评估，SkCoder在所有方面均优于基线

## 写作特征备注
- 标题结构：工具名: 描述（SkCoder: A Sketch-based Approach...）
- 摘要是否有数字：是（30.30%、35.39%、29.62%、120.1%、200k、20个基线、5个指标）
- 是否有RQ：否（按实验编号组织，但有明确的实验问题）
- 是否有Motivating Example：是（Figure 1和Figure 2详细展示了开发者代码复用过程和草图提取示例）
- 贡献点数量：3

## 结论
SkCoder通过模拟开发者的代码复用行为，提出检索-草图-编辑的三阶段流水线，有效提取相似代码中的有用模式并结合需求生成高质量代码，在多个数据集和指标上显著优于现有方法。
