# Are Human Rules Necessary? Generating Reusable APIs with CoT Reasoning and In-Context Learning
# 人工规则是否必要？基于思维链推理和上下文学习生成可复用API

**来源**: FSE 2024 | **作者**: Yubo Mai 等

## 摘要
开发者在Stack Overflow上寻找解决方案时，代码片段往往难以直接复用。先前工作APIzator通过规则化方法将SO代码片段转换为API，但深入分析发现其92.5%生成的API实际上无意义且难以使用，且手工规则复杂、难以扩展到其他编程语言。本文提出Code2API，利用大语言模型通过精心设计的提示自动执行APIzation，结合思维链（CoT）推理和少样本上下文学习，无需额外训练或手工规则。评估表明Code2API在识别方法参数（65%）和返回语句（66%）方面分别超越APIzator 15.0%和16.5%，且在生成有意义的方法名方面甚至超越人类水平，并成功扩展到Python数据集。

## 引言核心
- Stack Overflow代码片段广泛被开发者复制粘贴，但往往无法直接使用（缺少导入声明等）
- 将SO代码片段转换为可复用API需要多个步骤：恢复导入、生成方法名、提取参数、推断返回语句、创建异常声明
- APIzator的规则方法存在两个关键问题：90%生成的API不可用（方法名无意义），规则过于复杂且无法泛化
- LLM在代码生成方面展现出强大能力，启发了基于提示工程的轻量级解决方案
- 核心研究问题：能否设计模型为SO代码片段生成可用API并轻松泛化到其他编程语言？

## 方法概述
Code2API的核心方法是提示工程，通过精心设计的提示引导LLM完成APIzation任务。具体采用少样本上下文学习和思维链推理两种策略：少样本学习通过提供少量示例帮助LLM理解任务；思维链推理引导LLM像熟练开发者一样逐步解决问题——先理解代码功能，再识别参数，然后推断返回值，最后生成方法名。

Code2API不需要额外的模型训练或手工规则，可轻松部署在个人电脑上，不依赖外部工具。这种极其轻量的方法与基于规则的方法（需要手动设计规则）和基于机器学习的方法（需要大量训练数据）形成鲜明对比。框架还成功扩展到Python数据集，验证了其跨语言泛化能力。

## 关键实验发现
- RQ1（参数和返回语句识别）：Code2API在方法参数识别（65%）和返回语句识别（66%）上分别超越APIzator 15.0%和16.5%
- RQ2（方法名生成）：用户研究表明Code2API生成的方法名质量优于APIzator，甚至超越人类水平
- RQ3（实用性）：开发者更愿意使用Code2API生成的API，凸显了工具的实际应用价值
- RQ4（跨语言泛化）：成功扩展到Python数据集，性能与Java相当，验证了泛化能力

## 写作特征备注
- 标题结构：反问句式（Are Human Rules Necessary?）+ 任务描述副标题
- 摘要是否有数字：是（92.5%、65%、66%、15.0%、16.5%）
- 是否有RQ：是（明确的研究问题驱动）
- 是否有Motivating Example：是（Figure 1展示人工APIzation的完整流程）
- 贡献点数量：3（框架提出、全面评估、跨语言扩展）

## 结论
Code2API证明了基于LLM的提示工程方法可以替代复杂的手工规则，以更轻量、更通用的方式实现SO代码片段的API化，且在方法名生成质量上甚至超越人类水平。
