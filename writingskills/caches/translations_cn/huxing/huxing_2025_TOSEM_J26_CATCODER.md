# CatCoder: Repository-Level Code Generation with Relevant Code and Type Context
# CatCoder：基于相关代码和类型上下文的仓库级代码生成

**来源**: TOSEM 2025 | **作者**: Zhiyuan Pan 等

## 摘要
大语言模型（LLM）在代码生成任务中展现了卓越能力，但仓库级代码生成面临独特挑战，特别是需要利用分布在仓库多个文件中的信息。本文提出CatCoder，一个面向静态类型编程语言的新型代码生成框架，通过整合相关代码和类型上下文来增强仓库级代码生成。CatCoder利用静态分析器提取类型依赖关系，并将其与检索到的代码合并，为LLM构建全面的提示。在包含199个Java任务和90个Rust任务的基准测试中，CatCoder在compile@k和pass@k指标上分别比RepoCoder基线提升了14.44%和17.35%。

## 引言核心
- 仓库级代码生成需要跨文件的上下文信息，仅提供文件内上下文会导致LLM产生幻觉
- 现有基于检索的方法（如RepoCoder）在代码重复度低或功能新颖时难以捕获所有必要的API调用和字段访问
- 类型上下文（type context）可作为LLM的有价值参考，提供丰富的字段和方法信息
- CatCoder聚焦于静态类型语言（Java、Rust），可通过静态分析器可靠地提取类型信息
- 首次为Rust构建了仓库级代码生成基准测试

## 方法概述
CatCoder框架分为三个阶段运行。首先，从仓库中检索与目标函数相关的代码片段。其次，调用静态分析器获取目标函数的依赖类型，并构建类型上下文的文本表示，包括相关类型的字段和方法签名。最后，将检索到的代码和类型上下文整合到单一提示中，使用LLM生成目标函数。

CatCoder的核心创新在于引入"类型上下文"概念，它封装了嵌套作用域中的局部知识，作为代码检索的补充，帮助LLM更深入地理解仓库结构。该框架运行在冻结的LLM之上，不需要外部数据库或额外的模型训练。

## 关键实验发现
- RQ1（有效性）：CatCoder在compile@k和pass@k上分别比RepoCoder提升14.44%和17.35%，显著优于vanilla LLM和In-File上下文
- RQ2（泛化性）：在多种LLM（包括代码专用模型和通用模型）上均表现出一致的性能提升
- RQ3（可扩展性）：在大型开源仓库上的时间消耗评估证明了CatCoder的可扩展性和实用性

## 写作特征备注
- 标题结构：工具命名型（CatCoder: ...with...）
- 摘要是否有数字：是（199个Java任务、90个Rust任务、14.44%、17.35%）
- 是否有RQ：是
- 是否有Motivating Example：是（Apache Commons Math的triu方法示例）
- 贡献点数量：4

## 结论
CatCoder通过结合代码检索和静态分析提取的类型上下文，有效提升了仓库级代码生成的编译率和测试通过率，为静态类型语言的代码生成提供了实用的增强框架。
