# PS3: Precise Patch Presence Test based on Semantic Symbolic Signature
# PS3：基于语义符号签名的精确补丁存在性测试

**来源**: ICSE 2024 | **作者**: Qi Zhan 等

## 摘要
在软件开发中，漏洞对用户构成重大威胁，补丁是应对漏洞最有效的方式。在大规模软件系统中，测试每个受影响二进制文件中安全补丁的存在性对确保系统安全至关重要。现有方法主要关注在相同编译选项下编译的补丁检测，但开发者在不同场景下常使用不同编译选项，导致现有方法不准确。本文提出PS3，利用符号仿真提取在不同编译选项下稳定的语义级签名，通过在语义层面比较参考和目标的签名来精确测试补丁存在性。在包含62个CVE、3,631个（CVE, 二进制）对的数据集上，PS3达到精确率0.82、召回率0.97、F1值0.89，比SOTA基线F1值提升33%。

## 引言核心
- 新发现漏洞数量近年快速增长，补丁是应对漏洞最有效的方式
- 大规模软件系统中可能有数千个二进制文件，需确保每个都已打补丁
- 源代码与二进制之间的语义鸿沟使得直接关联源码修改与汇编代码变更困难
- 现有方法严重依赖语法信息，但不同编译选项编译的二进制在语法层面差异很大
- 现有方法仅在参考二进制与目标二进制使用相同编译选项时有效，实际场景中编译选项常不同

## 方法概述
PS3的核心思想分为两部分：签名提取和签名匹配。在签名提取阶段，PS3使用符号仿真在符号环境中执行整个受影响函数，收集副作用（如内存存储数据），从函数入口开始跟踪寄存器和内存相对于函数参数和初始内存环境的变化，提取四种类型的签名。对于参考二进制，仅追踪与修改代码对应的效果；对于目标二进制，需收集所有可能受影响函数的完整签名集。

在签名匹配阶段，PS3将从目标二进制提取的签名与参考进行比较。由于不同编译选项可能导致语法不同但语义等价的表达式，PS3利用定理证明器在语义层面验证两个签名的等价性。这使得PS3能够在编译选项不同的情况下精确测试目标二进制。

## 关键实验发现
- RQ1（有效性）：PS3达到精确率0.82、召回率0.97、F1值0.89，比SOTA基线F1值提升33%（0.22）
- RQ2（跨编译选项稳定性）：PS3在不同编译器和优化级别的各种组合下保持稳定性能

## 写作特征备注
- 标题结构：工具名缩写:描述（PS3: Precise Patch Presence Test based on Semantic Symbolic Signature）
- 摘要是否有数字：是（3,631对、62个CVE、0.82/0.97/0.89、33%）
- 是否有RQ：是
- 是否有Motivating Example：是（CVE-2020-22019 FFmpeg漏洞的详细示例）
- 贡献点数量：3

## 结论
PS3通过符号仿真提取语义级签名并利用定理证明器进行语义匹配，有效解决了现有补丁存在性测试方法在不同编译选项下失效的问题，在自建数据集上显著优于现有方法。
