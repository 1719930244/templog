# Improving Deep Learning Framework Testing with Model-Level Metamorphic Testing
# 基于模型级变质测试改进深度学习框架测试

**来源**: ISSTA 2025 | **作者**: Xiang Chen 等

## 摘要
深度学习（DL）框架（如TensorFlow、PyTorch）是DL应用的基础设施，其正确性至关重要。现有的DL框架测试方法主要基于API级别的变质关系，但这些方法覆盖的bug类型有限。本文提出了一种模型级变质测试方法，通过在模型层面定义变质关系来检测更多类型的框架bug。具体而言，我们设计了多种模型级变质关系（如模型等价变换、训练确定性等），并实现了自动化测试框架。在TensorFlow和PyTorch上的实验表明，该方法能检测到现有方法遗漏的bug。

## 引言核心
- DL框架bug可能导致模型训练错误或推理结果不正确，影响下游应用
- 现有测试方法（如CRADLE、LEMON）主要关注API级别的差异测试
- API级别测试的局限：只能检测单个API的bug，无法发现API组合或模型级别的bug
- 核心insight：模型级别的变质关系可以捕获更复杂的框架行为异常

## 方法概述
1. **变质关系定义**：在模型级别定义多种变质关系（MR），包括模型结构等价变换MR、训练过程确定性MR、数值精度MR等
2. **测试用例生成**：基于MR自动生成源测试用例和跟随测试用例
3. **差异检测**：比较变质关系两侧的输出，检测违反MR的情况
4. **Bug定位辅助**：通过缩小触发bug的最小模型来辅助定位

## 关键实验发现
- RQ1：在TensorFlow和PyTorch上共检测到N个之前未知的bug
- RQ2：模型级MR比API级MR能检测到更多类型的bug
- RQ3：消融实验表明每种MR都有独特贡献
- 已向官方提交bug报告，部分已被确认和修复

## 结论
本文提出模型级变质测试方法，扩展了DL框架测试的能力边界。实验证明该方法能有效发现现有方法遗漏的框架bug。
