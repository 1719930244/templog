Diffploit: Facilitating Cross-Version Exploit Migration for
Open Source Library Vulnerabilities
Zirui Chen
The State Key Laboratory of
Blockchain and Data Security,
Zhejiang University
Hangzhou, China
chenzirui@zju.edu.cn
Zhipeng Xue
The State Key Laboratory of
Blockchain and Data Security,
Zhejiang University
Hangzhou, China
zhipengxue@zju.edu.cn
Jiayuan Zhou
Queen’s University
Kingston, Canada
jiayuan.zhou@queensu.ca
Xing Hu∗
The State Key Laboratory of
Blockchain and Data Security,
Zhejiang University
Hangzhou, China
xinghu@zju.edu.cn
Xin Xia∗
The State Key Laboratory of
Blockchain and Data Security,
Zhejiang University
Hangzhou, China
xin.xia@acm.org
Xiaohu Yang
The State Key Laboratory of
Blockchain and Data Security,
Zhejiang University
Hangzhou, China
yangxh@zju.edu.cn
Abstract
Exploits are commonly used to demonstrate the presence of library
vulnerabilities and validate their impact across different versions.
However, their direct application to alternative versions often fails
due to breaking changes introduced during evolution. These fail-
ures stem from both changes in triggering conditions (e.g., API
refactorings) and broken dynamic environments (e.g., build or run-
time errors), which are challenging to interpret and adapt manually.
Existing techniques primarily focus on code-level trace alignment
through fuzzing, which is both time-consuming and insufficient for
handling environment-level failures. Moreover, they often fall short
when dealing with complicated triggering condition changes across
versions. To overcome this, we proposeDiffploit, an iterative,
diff-driven exploit migration method structured around two key
modules: the Context Module and the Migration Module. The Con-
text Module constructs contexts derived from analyzing behavioral
discrepancies between the target and reference versions, which
capture the failure symptom and its related diff hunks. Leveraging
these contexts, the Migration Module guides an LLM-based adap-
tation through an iterative feedback loop, balancing exploration
of diff candidates and gradual refinement to resolve reproduction
failures effectively. We evaluateDiffploiton a large-scale dataset
containing 102 Java CVEs and 689 version-migration tasks across
79 libraries.Diffploitsuccessfully migrates 84.2% exploits, outper-
forming the change-aware test repair toolTaRGETby 52.0% and the
rule-based tool inIDEAby 61.6%. Beyond technical effectiveness,
Diffploitidentifies 5 CVE reports with incorrect affected version
ranges, three of which have been confirmed. We also discover 111
unreported versions in GitHub Advisory Database.
CCS Concepts
•Security and privacy→Software security engineering.
Keywords
Library Vulnerabilities, Exploit Migration, Affected Version
∗Corresponding authors
1 Introduction
Open-source libraries serve as critical infrastructure in modern
software development, allowing developers to avoid redundant
reimplementation and accelerate the development process [32, 51,
57, 65, 71]. However, the widespread adoption of open-source li-
braries raises concerns about the risk posed by vulnerabilities in
these libraries [10, 23, 37, 42, 43, 45, 64, 68–70], as they can prop-
agate from upstream libraries to downstream projects [5, 33, 35].
Given that libraries often evolve rapidly and downstream projects
may depend on a wide range of versions, it becomes essential to
assess the impact of vulnerabilities across versions [4, 49]. To this
end, developers often employ publicly disclosed exploits to eval-
uate whether and how vulnerable behavior manifests in different
versions [66], such as identifying affected library versions [13, 29]
and assessing exploitability in downstream projects with various
affected versions [10, 17, 20, 31, 70].
However, simply reusing the original exploit on other affected
versions frequently fails to reproduce without adaptation [13, 66],
since disclosed exploits are typically crafted for the version in which
the vulnerability was originally reported and do not generalize
across other affected versions. These failures often result from
(1) broken dynamic environments [26, 61, 66] and (2) changes in
the underlying triggering condition [67]. Manually understanding
and resolving these issues is often time-consuming and requires
substantial expertise, highlighting the need for automated exploit
migration. Existing studies have demonstrated the feasibility of
migrating exploits across versions [13, 29], typically by aligning
execution traces via API matching. Despite their success in handling
minor API changes, these approaches often rely on fuzzing, which
can be time-consuming, especially when multiple versions require
migration. More importantly, they overlook two critical challenges
that frequently arise in practice:
❶ Broken Dynamic Environment: Previous methods primarily
address code-level variations, neglecting the incompatibilities intro-
duced by environmental changes such as dependency upgrades or
runtime configurations. For instance, the exploit for CVE-2020-5245
[55] fails with a runtime error in version1.3.8due to an updated
arXiv:2511.12950v1  [cs.SE]  17 Nov 2025
Zirui Chen, Zhipeng Xue, Jiayuan Zhou, Xing Hu, Xin Xia, and Xiaohu Yang
Reference Exploit (3.0.0.RELEASE)Migrated Exploit (2.0.8.RELEASE)[Failure Indicator]-Package does not exist[Related Diff]-{Classname}.java
3.0.0.RELEASE
2.0.8.RELEASE
Supporting Diff{Classname}.java:-package org.springframework.security.vote;…-package org.springframework.security;…-package org.springframework.security.util;…
UnanimousBasedTests.java:-ConfigAttributeDefinitionconfig = new           ConfigAttributeDefinition(new String[]{"ROLE_1", "DENY_FOR_SURE"});+ List<ConfigAttribute> config =  SecurityConfig.createList(new String[]{"ROLE_1", "DENY_FOR_SURE"});
AuthorityUtils.java:-public static GrantedAuthority[] commaSeparatedStringToAuthorityArray(String authorityString) {…-return authorities;-}
[Failure Indicator]-Cannot find symbol[Related Diff]-UnanimousBasedTests.java-AuthorityUtils.java
CVE-2024-22257Library:spring-security-coreRequire Migration:2.0.0 -2.0.8.RELEASE
NVD:5.7.0 to 5.7.125.8.0 to 5.8.116.0.0 to 6.0.96.1.0 to 6.1.86.2.0 to 6.2.3
ReferenceReported
Omitted!Target
Causing Diff Supporting Diff
Figure 1: Migrating the exploit of CVE-2024-22257 from version 3.0.0.RELEASE to 2.0.8.RELEASE byDiffploit.
library (javassist), despite identical exploit code. Such environment-
induced failures may surface across multiple phases, including the
build process and runtime [63], and exhibit considerable variability
across libraries, posing significant challenges to mitigation.
❷ Complicated Triggering Condition Evolution: When API in-
terfaces undergo substantial changes, refactoring [56], or removal
between versions, existing trace alignment methods, such as identi-
fying function renaming or function merging/splitting [13], strug-
gle to identify suitable replacements. A representative example is
CVE-2024-22257 [16] illustrated in Figure 1, where critical methods
(createListandcreateAuthorityList) are absent in2.0.8.RELEASE, re-
quiring alternative APIs with significantly different signatures and
semantics, which cannot be effectively addressed through existing
API matching strategies. Incorrect or inadequate matching in these
scenarios leads directly to ineffective migration efforts.
Addressing these challenges requires a comprehensive approach
that considers both environmental adjustments and intelligent API
adaptation mechanisms, beyond simple trace or naming alignment.
To effectively address the challenge of exploit migration across ver-
sions, we introduces an iterative, diff-driven LLM (Large Language
Model) framework,Diffploit. The key idea is to iteratively adapt
failed exploits using version-aware context and feedback. When a
migration attempt fails,Diffploitcompares the behavior of target
version against a successful reference version to identify failure
indicators. These indicators trigger the construction of a structured
migration context by theContext Module:Causing Diffsthat
likely led to the failure, andSupporting Diffsthat may help resolve
it. This context guides theMigration Moduleto adapt the exploit.
A simulated annealing strategy is designed to explore and refine
adaptations across multiple iterations. After each attempt, the up-
dated exploit is re-executed, and new feedback is collected to guide
the next cycle. Through this closed-loop process,Diffploitincre-
mentally reduces discrepancies and achieves effective migration,
even in the face of significant API or environment changes.
We evaluateDiffploiton a large-scale open source dataset of
Java library vulnerability exploits [57], comprising 102 CVEs and
their explicitly affected versions across 79 libraries. Among them,
we identify 30 exploits that require migration across 689 versions,
which is comparable to prior studies in the C/C++ domain [ 13],
involving 30 CVEs and 470 versions. Specifically,Diffploitsuc-
cessfully migrates 580 out of the 689 exploits to target versions in
23 CVEs, achieving a success rate of 84.2%. Compared to the re-
cent change-aware test repair research [48],Diffploitoutperforms
TaRGETby 52.0% and surpasses the rule-based approach inIDEA
by 61.6%, highlighting the effectiveness ofDiffploitin harnessing
the capabilities of LLMs for exploit migration. We demonstrate the
rationality ofDiffploit’s design through ablation studies, where
it achieves a 46.1% improvement over the base model. To validate
the practicality and correctness of exploits migrated byDiffploit,
we identify previously undisclosed vulnerable versions based on
the migrated exploits on five CVE vulnerabilities and contact the
CNAs (CVE Numbering Authority) [11] for confirmation. Among
them, three cases are confirmed, with our submitted exploit links
incorporated into the reference links. Meanwhile, we submit six
pull requests to the GitHub Advisory Database to include a total of
111 missing versions detected byDiffploit, of which 82 versions
are accepted. We further demonstrate thatDiffploiteffectively
overcomes the previously mentioned challenges with a low cost.
This paper makes the following main contributions:
• We proposeDiffploit, a novel discrepancy-driven approach that
automatically migrates exploits from target versions to reference
versions. Both the source code and dataset ofDiffploitare
available on our website [9]
• We conduct an evaluation on 689 versions and demonstrate that
Diffploitsuccessfully migrates exploits for 580 of them, out-
performing our baselines.
• Our migrated exploits reveal five CVEs with inaccurate affected
version ranges (three confirmed by CNAs) and uncover 111 af-
fected versions missing from the GitHub Advisory Database.
Diffploit: Facilitating Cross-Version Exploit Migration for Open Source Library Vulnerabilities
2 Motivation
In this section, we introduce the usage scenario and a motivating
example to illustrate the challenges addressed byDiffploit.
2.1 Usage Scenario
In real-world vulnerability management, our method is designed
to support two practical usage scenarios:
(1) Adapting ineffective exploits to confirmed affected versions.
Disclosed exploits are crucial for validating whether a specific
project is affected by a known upstream vulnerability. However,
these exploits are typically crafted for a particular version of a
vulnerable library and often fail to function on other affected ver-
sions due to code or environment changes. For example, suppose a
security advisory confirms that version 4.0.56 of the librarynetty-
codec-httpis affected by CVE-2021-43797, but the public exploit only
works on versions above 4.1.0.CR7 [55]. Developers using version
4.0.56 are left without a working exploit to verify the vulnerability
in their context.Diffploitaddresses this gap by automatically
adapting existing exploits to these confirmed yet incompatible ver-
sions, enabling practical verification in real-world environments.
(2) Discovering previously unreported affected versions. Manu-
ally curated vulnerability reports often contain inaccuracies and
omissions [7, 12, 18, 30, 41]. When a migrated exploit successfully
triggers the vulnerability in a version not listed in public advisories,
it suggests that the affected range may be broader than disclosed.
Thus,Diffploitcan assist in identifying missing affected versions
and improving the completeness of vulnerability databases. It is
worth noting, however, that ifDiffploitfails to migrate an ex-
ploit to a particular version, this does not necessarily mean the
version is unaffected, and additional analysis is required [25], such
as introducing commit analysis [2, 8, 60].
2.2 Motivating Example
Figure 1 presents a motivating example fromspring-security-core,
demonstrating howDiffploitfacilitates exploit migration across
versions. Through this process, we identify that versions prior to
5.7.0.RELEASEare affected by CVE-2024-22257, although they are
not included in the CVE report. For versions above3.0.0.RELEASE, a
publicly disclosed exploit for CVE-2024-22257 is available to repro-
duce the vulnerability, which serves as the reference exploit. The
reference exploit fails to execute directly on earlier versions, such
as2.0.8.RELEASE, because it depends on APIs introduced in later
versions (e.g., line 16, line 23) and is affected by breaking changes
introduced during updates (refactoring existing APIs to various
packages) [52], which requires exploit migration.
Recent advances in artificial intelligence, especially LLMs, demon-
strate strong capabilities in various tasks [21, 34, 44, 48, 54, 62, 72],
like understanding complex documentation [72] and resolving er-
rors [21, 54]. However, without sufficient contextual information,
LLMs often struggle to update exploits using the appropriate APIs
of the target versions. Furthermore, in earlier versions, LLMs fre-
quently fail to generate valid API calls due to the lack of correspond-
ing usage patterns in their training data [50]. These limitations hin-
der the effectiveness of LLMs in generating reliable exploits tailored
to target versions. We observe that providing diffs between the tar-
get version and the reference versions to LLMs enables them to infer
the root causes of the failures and identify adaptation strategies,
such as locating alternative APIs.
Based on this insight, we identify two types of diffs that facilitate
exploit migration:Causing DiffandSupporting Diff. Failures in
exploit reproduction, either due to modifications in triggering con-
ditions or environmental breaks, are caused by changes introduced
in the evolution of the library(causing diff). Meanwhile, libraries
themselves often contain internal adaptations to these changes,
which can provide LLMs with guidance for migration(supporting
diff). Take CVE-2024-22257 as an example:
• Causing Diff: The cause of thePackage does not existerror from
line 5 to line 11 is the result of refactoring or modifications to
the class file. Specifically, the corresponding hunks are those in-
volving target package name changes, such as the removal of the
package declaration linepackage org.springframework.security
in theConfigAttributeclass. These changes provide LLMs with
accurate package structure information of the target version,
thereby reducing hallucinations such as generating outdated or
non-existent import paths.
• Supporting Diff: For the modification in line 16, a change in
UnanimousBasedTestsreflects a response to the refactoring of
ConfigAttributeDefinitionand guides the modification in resolv-
ing theCannot find symbolerror for thecreateListmethod. In
addition, the diff inAuthorityUtilsprovides explicit guidance for
replacing the unavailablecreateAuthorityListmethod at line 23
with an alternative API introduced in the target version. These
diffs facilitate LLMs in addressing the evolution of triggering
conditions by identifying a suitable replacement for deleted APIs.
Building on the identified diffs, we proposeDiffploit, which
iteratively leverages the diffs to facilitate exploit migration through
a feedback loop.Diffploittakes nine steps to migrate the exploit
for CVE-2024-22257, despite the significant challenge of identifying
relevant information from the 2,555 diffs between the two versions.
3 Proposed Approach
In this section, we present our approach,Diffploit, detailing the
overall workflow as well as the design of its two core components:
theContext Moduleand theMigration Module.
3.1 Overview
Given a target version requiring exploit migration, our method iter-
atively repairs its behavioral discrepancies with reference exploits
through a self-adaption process. The reference version is chosen
from the set of reproduced versions to provide contextual guidance.
The overall process follows a discrepancy-driven loop. At each
iteration, we compare the execution outputs of the target version
and the reference version to identify reproduction failures. Each
detected failure indicator in the target version triggers the construc-
tion of a dedicated migration context via theContext Module.
This context encapsulates the failure symptom, its corresponding
diagnostic key, and the associated code-level differences that may
either underlie or assist in resolving the failure.
For each detected failure, the corresponding migration context
is passed to theMigration Module, which attempts to adapt the
exploit with the context. The migration process is guided by a
simulated annealing strategy that explores diffs within the context